<!DOCTYPE html>
<html>
<head>
    <title>Weather Update</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="box">
        <div id="city-name" style="background: #b3e6ed; text-align:center; font-size: 24px; margin-bottom: 10px; border-radius: 10px;">Nawada</div>
        <input type="text" id="search" value="Nawada" placeholder="Enter city name" style="margin-bottom: 20px;">
        <div id="weather-data" style="width:100%;">
            <h1 id="temp" style="font-size: 120px; text-align:center; color:white;"><sup>o</sup></h1>
            <p style="text-align:center; font-size: 40px; color:black;">Celsius</p>
            <p class="data">Wind speed: <span id="ws">--</span> km/h</p>
            <p class="data">Humidity: <span id="hmdty">--</span>%</p>
            <p id="error-msg" style="text-align:center; color:red; font-size:18px; display:none;"></p>
        </div>
        <div style="display: flex; justify-content: center;">
            <img width="200px" src="weather.png" alt="Weather Icon">
        </div>
    </div>
    <script>
        const apikey = "027f0432840d0817c59a6a3238a39530";
        const fetchWeather = async (city) => {
            let query = city.trim();
            const url = `https://api.openweathermap.org/data/2.5/weather?q=${encodeURIComponent(query)}&units=metric&appid=${apikey}`;
            // Clear previous error message before fetching
            document.getElementById('error-msg').textContent = '';
            document.getElementById('error-msg').style.display = 'none';
            try {
                const response = await fetch(url);
                const result = await response.json();
                if (result.cod === 200) {
                    document.getElementById('temp').innerHTML = `${result.main.temp}<sup>o</sup>`;
                    document.getElementById('ws').textContent = result.wind.speed;
                    document.getElementById('hmdty').textContent = result.main.humidity;
                    document.getElementById('city-name').textContent = result.name;
                } else {
                    document.getElementById('temp').innerHTML = `N/A<sup>o</sup>`;
                    document.getElementById('ws').textContent = '--';
                    document.getElementById('hmdty').textContent = '--';
                    document.getElementById('city-name').textContent = city;
                    document.getElementById('error-msg').textContent = 'City not found!';
                    document.getElementById('error-msg').style.display = 'block';
                }
            } catch (error) {
                document.getElementById('temp').innerHTML = `N/A<sup>o</sup>`;
                document.getElementById('ws').textContent = '--';
                document.getElementById('hmdty').textContent = '--';
                document.getElementById('city-name').textContent = city;
                document.getElementById('error-msg').textContent = 'Error fetching data!';
                document.getElementById('error-msg').style.display = 'block';
                console.error(error);
            }
        };

        // Fetch weather for the initial city in the input box
        window.onload = function() {
            fetchWeather(document.getElementById('search').value);
        };

        // Add an event listener to the input field to fetch weather on enter key press
        document.getElementById('search').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                fetchWeather(this.value);
            }
        });
    </script>
</body>
</html>
